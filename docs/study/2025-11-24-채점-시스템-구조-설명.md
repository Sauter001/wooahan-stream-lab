# ì±„ì  ì‹œìŠ¤í…œ êµ¬ì¡° ì„¤ëª…

Stream Labì˜ ì±„ì  ì‹œìŠ¤í…œì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ê¹Šì´ ë“¤ì—¬ë‹¤ë³¸ë‹¤. ì‚¬ìš©ìê°€ ì½”ë“œë¥¼ ì €ì¥í•˜ëŠ” ìˆœê°„ë¶€í„° ì±„ì  ê²°ê³¼ê°€ í™”ë©´ì— ë‚˜íƒ€ë‚˜ê¸°ê¹Œì§€, ê° ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë–¤ ì—­í• ì„ í•˜ê³  ì–´ë–»ê²Œ í˜‘ë ¥í•˜ëŠ”ì§€ ì‚´í´ë³´ì.

---

## ì „ì²´ íë¦„ ê°œìš”

```
[ì‚¬ìš©ìê°€ Level1.java ì €ì¥]
        â†“
[FileWatcherê°€ ë³€ê²½ ê°ì§€]
        â†“
[LevelGraderObserverì— ì´ë²¤íŠ¸ ì „ë‹¬]
        â†“
[Debounce í›„ ì±„ì  ì‹œì‘]
        â†“
[ì†ŒìŠ¤ ì»´íŒŒì¼ (gradlew compileJava)]
        â†“
[í´ë˜ìŠ¤ ë™ì  ë¡œë”©]
        â†“
[ê° ë¬¸ì œë³„ ì±„ì ]
    â”œâ”€ Validator: ì½”ë“œ êµ¬ì¡° ê²€ì¦
    â””â”€ Grader: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰
        â†“
[ê²°ê³¼ ì¶œë ¥]
```

---

## 1ë‹¨ê³„: íŒŒì¼ ë³€ê²½ ê°ì§€

### FileWatcherì˜ ì—­í• 

ì‚¬ìš©ìê°€ IDEì—ì„œ `Level1.java`ë¥¼ ì €ì¥í•˜ë©´, íŒŒì¼ ì‹œìŠ¤í…œì— ì“°ê¸° ì´ë²¤íŠ¸ê°€ ë°œìƒí•œë‹¤. Javaì˜ `WatchService` APIë¥¼ í™œìš©í•œ `FileWatcher`ê°€ ì´ë¥¼ ê°ì§€í•œë‹¤.

```
solutions/
â”œâ”€â”€ level1/Level1.java  â† ë³€ê²½ ê°ì§€ ëŒ€ìƒ
â”œâ”€â”€ level2/Level2.java
â””â”€â”€ ...
```

### ì™œ FileWatcherì¸ê°€?

ì±„ì ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆë‹¤:
- ë²„íŠ¼ í´ë¦­
- ì£¼ê¸°ì  í´ë§
- **íŒŒì¼ ë³€ê²½ ê°ì§€** â†’ ê²°ì •

íŒŒì¼ ë³€ê²½ ê°ì§€ë¥¼ ì„ íƒí•œ ì´ìœ ëŠ” í”Œë ˆì´ì–´ê°€ ë¬¸ì œë¥¼ í’€ ë•Œ í•„ìš”í•œ ì¶”ê°€ ì¡°ì‘ì„ ì¤„ì´ê¸° ìœ„í•´ì„œë‹¤. 

> * **ì´ˆê¸° í’€ì´ ê³¼ì •**: ì½”ë“œ ì‘ì„± â†’ ì €ì¥ â†’ "ì±„ì " ë²„íŠ¼ í´ë¦­ â†’ ê²°ê³¼ í™•ì¸
> * **ê°œì„ ëœ í’€ì´ ê³¼ì •**: ì½”ë“œ ì‘ì„± â†’ ì €ì¥ â†’ ê²°ê³¼ í™•ì¸ (ìë™)

ì´ë ‡ë“¯, ì‚¬ìš©ìëŠ” ê·¸ëƒ¥ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì €ì¥í•˜ë©´ ëœë‹¤. ë³„ë„ì˜ "ì±„ì " ë²„íŠ¼ì„ ëˆ„ë¥¼ í•„ìš” ì—†ì´ ìì—°ìŠ¤ëŸ¬ìš´ ì›Œí¬í”Œë¡œìš° ì•ˆì—ì„œ í”¼ë“œë°±ì„ ë°›ëŠ”ë‹¤.

### ì™œ ìƒì‹œ ëŒ€ê¸° ìŠ¤ë ˆë“œì¸ê°€?

ê°œë°œ ì§„í–‰ ì¤‘ì— ë¬¸ë“ ì´ëŸ° ì˜ë¬¸ì´ ë– ì˜¬ëë‹¤. 

> "ì±„ì  ìš”ì²­ë§ˆë‹¤ FileWatcher ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ì±„ì ì‹œí‚¤ë©´ ì•ˆ ë˜ë‚˜ìš”? ì™œ êµ³ì´ ìŠ¤ë ˆë“œë¡œ ë¹¼ì„œ ìƒì‹œ ëŒ€ê¸°ì‹œí‚¨ í›„ ì´ë²¤íŠ¸ë¥¼ observeí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í–ˆë‚˜ìš”?"

ì¼ë°˜ì ì¸ ì„œë²„ì˜ ê²½ìš° ìš”ì²­ì´ ë“¤ì–´ì™€ì•¼ ê·¸ ì‘ë‹µì„ ì œê³µí•´ì£¼ëŠ” ë°©ì‹ì´ë‹¤. ì²˜ìŒì—ëŠ” ì´ êµ¬ì¡°ë¥¼ ì°¨ìš©í•´ì„œ êµ¬í˜„í•˜ë ¤ í–ˆê³ , ê·¸ëŸ¬ë ¤ë©´ ë°ëª¬ ìŠ¤ë ˆë“œ í˜•íƒœë¡œ ëŒì•„ê°€ì•¼ í•  ê±° ê°™ì•˜ë‹¤. ê·¸ëŸ¬ë‹¤ ìœ„ì˜ ì˜ë¬¸ì— ëŒ€í•´ ì¡°ê¸ˆ ë” ì €ìš¸ì§ˆí•´ë³¸ ê²°ê³¼ ë‹¤ìŒ íŒë‹¨ì— ë”°ë¼ ë°ëª¬ ìŠ¤ë ˆë“œ ë°©ì‹ì„ ìœ ì§€í•˜ê¸°ë¡œ í–ˆë‹¤. 

#### On-demand ë°©ì‹ì˜ ë¬¸ì œ

ë§Œì•½ ì±„ì  ìš”ì²­ë§ˆë‹¤ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤ë©´, ê·¸ "ìš”ì²­"ì€ ì–´ë””ì„œ ì˜¤ëŠ”ê°€?

```
[ì‚¬ìš©ìê°€ íŒŒì¼ ì €ì¥] â†’ [???] â†’ [Grader ìƒì„±] â†’ [ì±„ì ]
```

`???` ë¶€ë¶„ì— ë¬´ì–¸ê°€ê°€ ìˆì–´ì•¼ í•œë‹¤. ì„ íƒì§€ëŠ” ë‘ ê°€ì§€ë‹¤:

1. **ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ìš”ì²­**: "ì±„ì " ë²„íŠ¼ í´ë¦­, ëª…ë ¹ì–´ ì…ë ¥ ë“±
2. **ì‹œìŠ¤í…œì´ ì•Œì•„ì„œ ê°ì§€**: íŒŒì¼ ë³€ê²½ì„ ëˆ„êµ°ê°€ê°€ ì§€ì¼œë³´ê³  ìˆì–´ì•¼ í•¨

1ë²ˆì„ ì„ íƒí•˜ë©´ ì‚¬ìš©ì ê²½í—˜ì´ ë‚˜ë¹ ì§„ë‹¤. ì½”ë“œ ìˆ˜ì • â†’ ì €ì¥ â†’ ì±„ì  ë²„íŠ¼ í´ë¦­. ì´ ë°˜ë³µì´ ìˆ˜ì‹­, ìˆ˜ë°± ë²ˆ ì¼ì–´ë‚œë‹¤. ë§ˆì°°ì´ í¬ë‹¤.

2ë²ˆì„ ì„ íƒí•˜ë©´... ê²°êµ­ "ëˆ„êµ°ê°€ê°€ ì§€ì¼œë³´ê³  ìˆì–´ì•¼" í•œë‹¤. ê·¸ê²Œ ë°”ë¡œ **ìƒì‹œ ëŒ€ê¸° ìŠ¤ë ˆë“œ**ë‹¤.

#### ìƒì‹œ ëŒ€ê¸° ë°©ì‹ì˜ ì´ì 

```
[FileWatcher ìŠ¤ë ˆë“œ: í•­ìƒ ëŒ€ê¸° ì¤‘]
        â†“ (íŒŒì¼ ë³€ê²½ ê°ì§€)
[Observerì— ì´ë²¤íŠ¸ ì „ë‹¬]
        â†“
[ì±„ì  ì‹œì‘]
```

**1. ì¦‰ê°ì ì¸ ë°˜ì‘**

íŒŒì¼ ì €ì¥ ìˆœê°„ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œë‹¤. ëŒ€ê¸° ì¤‘ì¸ ìŠ¤ë ˆë“œê°€ ì¦‰ì‹œ ê°ì§€í•˜ê³  ì²˜ë¦¬ë¥¼ ì‹œì‘í•œë‹¤. í´ë§(ì£¼ê¸°ì  í™•ì¸)ë³´ë‹¤ ë°˜ì‘ ì†ë„ê°€ ë¹ ë¥´ê³  ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì ì´ë‹¤.

**2. ì‚¬ìš©ì ê°œì… ë¶ˆí•„ìš”**

IDEì—ì„œ Ctrl+Së§Œ ëˆ„ë¥´ë©´ ëœë‹¤. ì¶”ê°€ í–‰ë™ ì—†ì´ ìë™ìœ¼ë¡œ ì±„ì ì´ ì‹œì‘ëœë‹¤. ì´ê²Œ Stream Labì´ ì¶”êµ¬í•˜ëŠ” "ë§ˆì°° ì—†ëŠ” ê²½í—˜"ì´ë‹¤.

**3. OS ìˆ˜ì¤€ ìµœì í™”**

Javaì˜ `WatchService`ëŠ” OSì˜ íŒŒì¼ ì‹œìŠ¤í…œ ì´ë²¤íŠ¸ë¥¼ í™œìš©í•œë‹¤. ë°”ìœ ëŒ€ê¸°(busy waiting)ê°€ ì•„ë‹ˆë¼, OSê°€ ì•Œë ¤ì¤„ ë•Œê¹Œì§€ ìŠ¤ë ˆë“œê°€ ë¸”ë¡œí‚¹ëœë‹¤. CPUë¥¼ ë‚­ë¹„í•˜ì§€ ì•ŠëŠ”ë‹¤.

**4. ìƒëª…ì£¼ê¸° ê´€ë¦¬ ë‹¨ìˆœí™”**

ë ˆë²¨ ì§„ì… ì‹œ Observer ë“±ë¡, ë ˆë²¨ ì¢…ë£Œ ì‹œ Observer í•´ì œ. ìƒíƒœ ì „ì´ê°€ ëª…í™•í•˜ë‹¤. ë°˜ë©´ ìš”ì²­ë§ˆë‹¤ ê°ì²´ë¥¼ ìƒì„±/íŒŒê´´í•˜ë©´ ìƒëª…ì£¼ê¸° ê´€ë¦¬ê°€ ë³µì¡í•´ì§„ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ìŒì‹ì ì—ì„œ ì£¼ë¬¸í•˜ë©´ ì§„ë™ë²¨ì„ ë°›ëŠ”ë‹¤. ì†ë‹˜ì´ ê³„ì† ì¹´ìš´í„°ì— ê°€ì„œ "ì œ ìŒì‹ ëë‚˜ìš”?"ë¼ê³  ë¬»ì§€ ì•ŠëŠ”ë‹¤. ë²¨ì´ ìš¸ë¦¬ë©´(ì´ë²¤íŠ¸) ê·¸ë•Œ ê°€ì„œ ë°›ëŠ”ë‹¤(ì²˜ë¦¬).

FileWatcherë„ ë§ˆì°¬ê°€ì§€ë‹¤. íŒŒì¼ ì‹œìŠ¤í…œì— "ë²¨"ì„ ë“±ë¡í•´ë‘ê³ , ë³€ê²½ì´ ìƒê¸°ë©´ ì•Œë¦¼ì„ ë°›ëŠ”ë‹¤. ì¦‰ **ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜**ë¥¼ ì ìš©í–ˆë‹¤. 

---

## 2ë‹¨ê³„: Debouncingê³¼ Observer íŒ¨í„´

### ì™œ Debounceê°€ í•„ìš”í•œê°€

IDEëŠ” ë³´í†µ ìë™ ì €ì¥ì„ ì§€ì›í•œë‹¤. ì‹¬ì§€ì–´ IntelliJëŠ” ê¸°ë³¸ ì„¸íŒ…ì´ ìë™ ì €ì¥ì´ë‹¤. ì´ë ‡ê²Œ ìë™ ì €ì¥ì„ ì ìš©í•œ ê²½ìš°, ì €ì¥í•  ë•Œ ì—¬ëŸ¬ ë²ˆì˜ ì“°ê¸° ì´ë²¤íŠ¸ë¥¼ ë°œìƒí•  ë•Œë¥¼ ê³ ë ¤í–ˆë‹¤. ìë™ í¬ë§·íŒ…, ì„ì‹œ íŒŒì¼ ìƒì„± ë“±ìœ¼ë¡œ ì¸í•´ í•œ ë²ˆì˜ ì €ì¥ì´ 2~3ê°œì˜ ì´ë²¤íŠ¸ë¡œ ì´ì–´ì§€ê¸°ë„ í•œë‹¤.

ë§¤ ì´ë²¤íŠ¸ë§ˆë‹¤ ì±„ì í•˜ë©´ ì»´íŒŒì¼ì´ ë¶ˆí•„ìš”í•˜ê²Œ ì—¬ëŸ¬ ë²ˆ ë˜ì–´ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ë¡œ ì´ì–´ì§ˆ ê²ƒì´ë‹¤. ë˜í•œ ì±„ì  ì¤‘ì´ë¼ëŠ” ì¶œë ¥ì´ ê³¼ë„í•˜ê²Œ ë˜ë‹ˆ, ê°€ë…ì„±ë„ ë–¨ì–´ì ¸ UX ì €í•˜ë¡œ ì´ì–´ì§ˆ ê²ƒì´ë‹¤.

ê·¸ë˜ì„œ **Debounce**ë¥¼ ì ìš©í–ˆë‹¤. ë§ˆì§€ë§‰ ì´ë²¤íŠ¸ í›„ 2ì´ˆ ë™ì•ˆ ì¶”ê°€ ì´ë²¤íŠ¸ê°€ ì—†ìœ¼ë©´ ê·¸ë•Œ ì±„ì ì„ ì‹œì‘í•œë‹¤.

```java
// LevelGraderObserver.java
private static final long DEBOUNCE_DELAY_SECONDS = 2;

@Override
public void onFileChanged(Path filePath) {
    if (pendingGrade != null && !pendingGrade.isDone()) {
        pendingGrade.cancel(false);  // ì´ì „ ì˜ˆì•½ ì·¨ì†Œ
    }

    pendingGrade = scheduler.schedule(() -> {
        executeGrading(filePath);
    }, DEBOUNCE_DELAY_SECONDS, TimeUnit.SECONDS);
}
```

### Observer íŒ¨í„´

`FileWatcher`ëŠ” `GraderObserver` ì¸í„°í˜ì´ìŠ¤ì— ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬í•œë‹¤. ë ˆë²¨ë§ˆë‹¤ ë‹¤ë¥¸ Observerê°€ ë“±ë¡ë˜ì–´ ê°ìì˜ ë°©ì‹ìœ¼ë¡œ ì±„ì ì„ ì²˜ë¦¬í•œë‹¤.

```
FileWatcher
    â”œâ”€ TutorialGraderObserver (Tutorial.java ê°ì‹œ)
    â””â”€ LevelGraderObserver (Level1~5.java, LevelSecret.java ê°ì‹œ)
```

ì´ êµ¬ì¡° ë•ë¶„ì— ìƒˆë¡œìš´ ë ˆë²¨ì´ë‚˜ ëª¨ë“œë¥¼ ì¶”ê°€í•´ë„ ê¸°ì¡´ ì½”ë“œë¥¼ ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ë‹¤.

---

## 3ë‹¨ê³„: ì»´íŒŒì¼ê³¼ í´ë˜ìŠ¤ ë¡œë”©

### ë™ì  ì»´íŒŒì¼

ì‚¬ìš©ìê°€ ìˆ˜ì •í•œ ì†ŒìŠ¤ë¥¼ ì±„ì í•˜ë ¤ë©´ ë¨¼ì € ì»´íŒŒì¼í•´ì•¼ í•œë‹¤. Gradleì„ í†µí•´ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.

```java
ProcessBuilder pb = new ProcessBuilder(gradleCommand, "compileJava", "-q");
int exitCode = process.waitFor();

if (exitCode != 0) {
    System.err.println("âŒ ì»´íŒŒì¼ ì‹¤íŒ¨. ë¬¸ë²• ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.");
    return false;
}
```

### í´ë˜ìŠ¤ ë¦¬ë¡œë”© ë¬¸ì œ

Javaì—ì„œ í•œ ë²ˆ ë¡œë“œëœ í´ë˜ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ì‹œ ë¡œë“œë˜ì§€ ì•ŠëŠ”ë‹¤. ê°™ì€ í´ë˜ìŠ¤ë¥¼ ë‘ ë²ˆ ìˆ˜ì •í•˜ë©´? ì²« ë²ˆì§¸ ë²„ì „ì´ ê³„ì† ì‹¤í–‰ëœë‹¤!

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ì»¤ìŠ¤í…€ ClassLoader**ë¥¼ ì‚¬ìš©í•œë‹¤.

```java
private Class<?> loadSolutionClass() throws Exception {
    // ì´ì „ ClassLoader ì •ë¦¬
    cleanUpClassLoader();

    // .class íŒŒì¼ ë°”ì´íŠ¸ë¥¼ ì§ì ‘ ì½ì–´ì„œ ìƒˆ í´ë˜ìŠ¤ë¡œ ë¡œë“œ
    byte[] classBytes = Files.readAllBytes(classFile);
    previousClassLoader = new ByteArrayClassLoader(
        getClass().getClassLoader(),
        className,
        classBytes
    );

    return previousClassLoader.loadClass(className);
}
```

ë§¤ ì±„ì ë§ˆë‹¤ ìƒˆë¡œìš´ ClassLoaderë¥¼ ìƒì„±í•˜ê³ , ì»´íŒŒì¼ëœ `.class` íŒŒì¼ì˜ ë°”ì´íŠ¸ë¥¼ ì§ì ‘ ì½ì–´ ìƒˆ í´ë˜ìŠ¤ë¥¼ ì •ì˜í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ í•­ìƒ ìµœì‹  ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤.

---

## 4ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë°ì´í„° êµ¬ì¡°

### ê³„ì¸µ êµ¬ì¡°

í…ŒìŠ¤íŠ¸ ë°ì´í„°ëŠ” JSON íŒŒì¼ë¡œ ê´€ë¦¬ëœë‹¤.

```
data/test-data/
â”œâ”€â”€ level1/level1.json
â”œâ”€â”€ level2/level2.json
â”œâ”€â”€ ...
â””â”€â”€ secret/secret.json
```

ê° JSON íŒŒì¼ì˜ êµ¬ì¡°:

```json
{
  "level": 1,
  "masterData": {
    "students": [...],
    "products": [...],
    "characters": [...]
  },
  "problems": [
    {
      "id": "1-1",
      "methodName": "filterEvenNumbers",
      "inputType": "students",
      "outputType": "List<String>",
      "testCases": [
        {
          "inputIds": [1, 2, 3],
          "expected": ["ê¹€ì² ìˆ˜", "ì´ì˜í¬"]
        }
      ]
    }
  ]
}
```

### LevelTestData í´ë˜ìŠ¤

JSONì„ Java ê°ì²´ë¡œ ë§¤í•‘í•˜ëŠ” ì—­í• :

```java
@Getter @Setter
public class LevelTestData {
    private int level;
    private List<Problem> problems;
    private MasterData masterData;

    public static class Problem {
        private String id;
        private String methodName;
        private String inputType;
        private String outputType;
        private List<TestCase> testCases;
        private ValidationConfig validation;
        private String requiresToolbox;  // "set", "permutation", "goldbach"
    }

    public static class TestCase {
        private List<Long> inputIds;
        private Object inputRaw;  // ë‹¨ìˆœ ì…ë ¥ìš©
        private Object expected;
    }
}
```

### TestDataAssembler: DTO â†’ Domain ë³€í™˜

JSON ë°ì´í„°ëŠ” ë‹¨ìˆœí•œ DTOë‹¤. ì‹¤ì œ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ë„ë©”ì¸ ê°ì²´(`Student`, `Product`, `GameCharacter` ë“±)ê°€ í•„ìš”í•˜ë‹¤. `TestDataAssembler`ê°€ ì´ ë³€í™˜ì„ ë‹´ë‹¹í•œë‹¤.

```java
public class TestDataAssembler {

    public List<Student> assembleStudents(List<StudentData> data) {
        return data.stream()
                .map(this::toStudent)
                .toList();
    }

    private Student toStudent(StudentData d) {
        return new Student(
            d.getName(),
            d.getGrade(),
            Subject.valueOf(d.getSubject()),
            d.getScore(),
            Gender.valueOf(d.getGender())
        );
    }
}
```

ë³µì¡í•œ ë„ë©”ì¸(ì˜ˆ: `GameCharacter`)ì€ ì—°ê´€ ì—”í‹°í‹° ì¡°ë¦½ë„ ì²˜ë¦¬í•œë‹¤:

```java
public List<GameCharacter> assembleCharacters(MasterData masterData) {
    // 1. Guild Map ìƒì„±
    Map<Long, Guild> guildMap = masterData.getGuilds().stream()
            .map(this::toGuild)
            .collect(Collectors.toMap(Guild::getId, Function.identity()));

    // 2. Item Map ìƒì„±
    Map<Long, Item> itemMap = masterData.getItems().stream()
            .map(this::toItem)
            .collect(Collectors.toMap(Item::getId, Function.identity()));

    // 3. Character ì¡°ë¦½ (Guild, Items ì—°ê²°)
    return masterData.getCharacters().stream()
            .map(d -> toCharacter(d, guildMap, itemMap))
            .toList();
}
```

---

## 5ë‹¨ê³„: ì±„ì  í”„ë¡œì„¸ìŠ¤

### LevelGraderì˜ ì±…ì„

ë¬¸ì œ í•˜ë‚˜ë¥¼ ì±„ì í•˜ëŠ” í•µì‹¬ ë¡œì§:

```java
public GradeResult gradeProblem(Problem problem, File sourceFile, Class<?> solutionClass) {
    // 1. Validatorë¡œ ì½”ë“œ êµ¬ì¡° ê²€ì¦
    ValidationResult validationResult = validateMethod(sourceFile, problem.getMethodName(), validator);
    if (!(validationResult instanceof ValidationResult.Ok)) {
        return new GradeResult(problem.getId(), validationResult, 0, totalTests);
    }

    // 2. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰
    int passedTests = runTestCases(problem, solutionClass);

    return new GradeResult(problem.getId(), validationResult, passedTests, totalTests);
}
```

ê²€ì¦ì´ ë¨¼ì €, ì‹¤í–‰ì€ ë‚˜ì¤‘. ì½”ë“œ êµ¬ì¡°ê°€ ê·œì¹™ì„ ìœ„ë°˜í•˜ë©´ ë¡œì§ì˜ í…ŒìŠ¤íŠ¸ëŠ” ì‹¤í–‰ì¡°ì°¨ í•˜ì§€ ì•ŠëŠ”ë‹¤.

#### ì™œ ì´ ìˆœì„œì¸ê°€?

ì´ ì„¤ê³„ì—ëŠ” ëª‡ ê°€ì§€ ì˜ë„ê°€ ìˆë‹¤.

**1. Fail Fast ì›ì¹™**

êµ¬ì¡°ì  ê·œì¹™(forë¬¸ ê¸ˆì§€, ì¬ê·€ ê¸ˆì§€ ë“±)ì„ ìœ„ë°˜í•œ ì½”ë“œëŠ” ê²°ê³¼ê°€ ë§ë“  í‹€ë¦¬ë“  "ë¶ˆí•©ê²©"ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ êµ³ì´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ì´ìœ ê°€ ì—†ë‹¤. ì¼ì° ì‹¤íŒ¨í•˜ê³ , ì¼ì° í”¼ë“œë°±ì„ ì£¼ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤.

**2. ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì„±**

í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì€ ë¹„ìš©ì´ í¬ë‹¤. ì»´íŒŒì¼ëœ í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•˜ê³ , ë¦¬í”Œë ‰ì…˜ìœ¼ë¡œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³ , ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ëŒë¦°ë‹¤. ì–´ì°¨í”¼ ê±°ë¶€ë  ì½”ë“œì— ì´ ë¹„ìš©ì„ ì“¸ í•„ìš”ê°€ ì—†ë‹¤.

**3. í”¼ë“œë°±ì˜ ëª…í™•ì„±**

ê²€ì¦ê³¼ ì‹¤í–‰ì„ ë¶„ë¦¬í•˜ë©´ í”¼ë“œë°±ì´ ëª…í™•í•´ì§„ë‹¤.

```
âŒ í˜¼í•©ëœ í”¼ë“œë°±: "í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (3/5 í†µê³¼), ê·¸ë¦¬ê³  forë¬¸ ì‚¬ìš© ê°ì§€"
âœ… ë¶„ë¦¬ëœ í”¼ë“œë°±: "forë¬¸ ì‚¬ìš© ê°ì§€ (15ë²ˆì§¸ ì¤„) - í…ŒìŠ¤íŠ¸ ë¯¸ì‹¤í–‰"
```

ì‚¬ìš©ìëŠ” "ì¼ë‹¨ êµ¬ì¡°ë¶€í„° ê³ ì¹˜ê³ , ê·¸ë‹¤ìŒ ë¡œì§ì„ í™•ì¸í•˜ì"ë¼ëŠ” ëª…í™•í•œ í–‰ë™ ì§€ì¹¨ì„ ì–»ëŠ”ë‹¤.

**4. í•™ìŠµ ëª©í‘œ ê°•ì œ**

Stream Labì˜ ëª©ì ì€ Stream API í•™ìŠµì´ë‹¤. forë¬¸ìœ¼ë¡œ ì •ë‹µì„ ë§ì¶°ë„ í•™ìŠµ ëª©í‘œë¥¼ ë‹¬ì„±í•œ ê²Œ ì•„ë‹ˆë‹¤. êµ¬ì¡° ê²€ì¦ì„ ë¨¼ì € í•¨ìœ¼ë¡œì¨ "ì˜¬ë°”ë¥¸ ë°©ì‹ìœ¼ë¡œ í’€ì–´ì•¼ í•œë‹¤"ëŠ” ì œì•½ì„ ê°•ì œí•œë‹¤.

**5. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬**

"ì½”ë“œê°€ ê·œì¹™ì„ ë”°ë¥´ëŠ”ê°€?"ì™€ "ì½”ë“œê°€ ì˜¬ë°”ë¥¸ ê²°ê³¼ë¥¼ ë‚´ëŠ”ê°€?"ëŠ” ë³„ê°œì˜ ì§ˆë¬¸ì´ë‹¤. ì´ë¥¼ ë³„ë„ì˜ ë‹¨ê³„ë¡œ ë‚˜ëˆ„ë©´:
- ValidatorëŠ” êµ¬ì¡°ë§Œ ë³¸ë‹¤ (AST ë¶„ì„)
- GraderëŠ” ê²°ê³¼ë§Œ ë³¸ë‹¤ (ì‹¤í–‰ + ë¹„êµ)

ê° ì»´í¬ë„ŒíŠ¸ì˜ ì±…ì„ì´ ë‹¨ìˆœí•´ì§€ê³ , í…ŒìŠ¤íŠ¸ì™€ ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§„ë‹¤.

### Validator ì²´ì¸

ì—¬ëŸ¬ Validatorê°€ ìˆœì°¨ì ìœ¼ë¡œ ê²€ì¦í•œë‹¤. **Composite íŒ¨í„´**ìœ¼ë¡œ ì—¬ëŸ¬ Validatorë¥¼ ì¡°ë¦½í•˜ê³ , **Strategy íŒ¨í„´**ìœ¼ë¡œ ê²°ê³¼ ì§‘ê³„ ë°©ì‹(Fast-Fail vs Collect-All)ì„ ì„ íƒí•œë‹¤. **Factory íŒ¨í„´**ìœ¼ë¡œ ë ˆë²¨ë³„ Validator ì¡°í•©ì„ ìº¡ìŠí™”í–ˆë‹¤.

> ğŸ“– **ì„¤ê³„ íŒ¨í„´ ìƒì„¸**: [ì½”ë“œ ì±„ì ê¸° ì„¤ê³„ ì„¸ë¶€ì‚¬í•­](./2025-11-22-ì½”ë“œ-ì±„ì ê¸°-ì„¤ê³„ì„¸ë¶€ì‚¬í•­.md)

```
CompositeValidator
    â”œâ”€ LoopValidator (for/while ê¸ˆì§€)
    â”œâ”€ RecursionValidator (ì¬ê·€ ê¸ˆì§€)
    â”œâ”€ HelperMethodValidator (í—¬í¼ ë©”ì„œë“œ ê¸ˆì§€)
    â”œâ”€ BlockLambdaValidator (ë¸”ë¡ ëŒë‹¤ ê¸ˆì§€, Level 1-3)
    â””â”€ MaxVariableDeclarationValidator (ë³€ìˆ˜ ì„ ì–¸ ì œí•œ)
```

ë ˆë²¨ì— ë”°ë¼ ë‹¤ë¥¸ Validator ì¡°í•©ì„ ì‚¬ìš©í•œë‹¤:

```java
private CompositeValidator getValidatorByLevel() {
    if (this.level <= 3) {
        return ViolationFactory.createStrictestValidator();
    }
    if (this.level <= 5) {
        return ViolationFactory.createBlockLambdaAllowedValidator();
    }
    return ViolationFactory.createSecretPhaseValidator();
}
```

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰

```java
private int runTestCases(Problem problem, Class<?> solutionClass) {
    int passed = 0;

    for (TestCase testCase : problem.getTestCases()) {
        // 1. ì…ë ¥ ì¤€ë¹„ (inputIds â†’ ë„ë©”ì¸ ê°ì²´)
        Object input = prepareInput(problem.getInputType(), testCase);

        // 2. ê¸°ëŒ€ê°’ ë³€í™˜
        Object expected = convertExpected(problem.getOutputType(), testCase.getExpected());

        // 3. ë©”ì„œë“œ ì°¾ê¸°
        Method method = findMethod(solutionClass, problem.getMethodName());

        // 4. ì‹¤í–‰ (ì‹œê°„ ì¸¡ì •)
        long startTime = System.nanoTime();
        Object actual = invokeWithToolbox(method, input, problem.getRequiresToolbox());
        long elapsedMs = (System.nanoTime() - startTime) / 1_000_000;

        // 5. ì‹œê°„ ì œí•œ ì²´í¬
        if (timeLimitMs != null && elapsedMs > timeLimitMs) {
            System.out.println("  â±ï¸ ì‹œê°„ ì´ˆê³¼");
            continue;
        }

        // 6. ê²°ê³¼ ë¹„êµ
        if (compareResults(expected, actual)) {
            passed++;
        }
    }

    return passed;
}
```

### inputIds ì²˜ë¦¬

`inputIds`ê°€ ìˆìœ¼ë©´ `masterData`ì—ì„œ í•´ë‹¹ IDì˜ ì—”í‹°í‹°ë§Œ ì¶”ì¶œ:

```java
private Object prepareInput(String inputType, TestCase testCase) {
    List<Long> inputIds = testCase.getInputIds();

    return switch (inputType.toLowerCase()) {
        case "students" -> filterById(
            assembler.assembleStudents(masterData.getStudents()),
            masterData.getStudents(),
            inputIds
        );
        case "products" -> filterById(...);
        case "characters" -> filterCharactersById(...);
        default -> testCase.getInputRaw();  // ë‹¨ìˆœ ì…ë ¥
    };
}
```

---

## 6ë‹¨ê³„: Toolbox ì£¼ì…

ì¼ë¶€ ë¬¸ì œëŠ” í—¬í¼ í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤. í•˜ì§€ë§Œ ì‚¬ìš©ìê°€ ì§ì ‘ ì •ì˜í•˜ë©´ ê·œì¹™ ìœ„ë°˜ì´ë‹¤. í•´ê²°ì±…: **Toolbox ì£¼ì…**.

```java
private Object invokeWithToolbox(Method method, Object input, String toolboxType) {
    if (toolboxType == null) {
        return method.invoke(null, input);
    }

    return switch (toolboxType) {
        case "set" -> {
            SetToolbox<?> toolbox = new SetToolboxImpl<>();
            yield method.invoke(null, input, toolbox);
        }
        case "permutation" -> {
            PermutationToolbox<?> toolbox = new PermutationToolboxImpl<>();
            yield method.invoke(null, input, toolbox);
        }
        case "goldbach" -> {
            GoldbachToolbox toolbox = new GoldbachToolboxImpl(maxN);
            yield method.invoke(null, input, toolbox);
        }
        default -> method.invoke(null, input);
    };
}
```

ì‚¬ìš©ì ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜:

```java
// Toolboxê°€ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë¨
public static Set<Set<Integer>> powerSet(Set<Integer> set, SetToolbox<Integer> tools) {
    return set.stream()
        .reduce(tools.emptySeed(), tools::extendAll, tools::merge);
}
```

---

## 7ë‹¨ê³„: ê²°ê³¼ ë¹„êµ

### íƒ€ì…ë³„ ë¹„êµ ì „ëµ

JSONì—ì„œ íŒŒì‹±ëœ `expected`ì™€ ì‹¤ì œ ë°˜í™˜ê°’ `actual`ì˜ íƒ€ì…ì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤:
- JSON ì •ìˆ˜ â†’ `Integer`, Java `Collectors.counting()` â†’ `Long`
- JSON ê°ì²´ í‚¤ â†’ `String`, Java Map í‚¤ â†’ `Boolean`

ì´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ìœ ì—°í•œ ë¹„êµ ë¡œì§:

```java
private boolean compareResults(Object expected, Object actual) {
    // ìˆ«ì ë¹„êµ (Integer, Long, Double í†µí•©)
    if (expected instanceof Number && actual instanceof Number) {
        double expectedVal = ((Number) expected).doubleValue();
        double actualVal = ((Number) actual).doubleValue();
        return Math.abs(expectedVal - actualVal) < EPSILON;
    }

    // Map ë¹„êµ (ì¤‘ì²©, íƒ€ì… ì°¨ì´ ì²˜ë¦¬)
    if (expected instanceof Map && actual instanceof Map) {
        return compareMaps((Map<?, ?>) expected, (Map<?, ?>) actual);
    }

    // ì¼ë°˜ ë¹„êµ
    return expected.equals(actual);
}
```

---

## ê²°ë¡ : ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• 

| ì»´í¬ë„ŒíŠ¸ | ì±…ì„ |
|----------|------|
| FileWatcher | íŒŒì¼ ë³€ê²½ ê°ì§€ |
| LevelGraderObserver | Debounce, ì±„ì  íŠ¸ë¦¬ê±° |
| Gradle | ì†ŒìŠ¤ ì»´íŒŒì¼ |
| ByteArrayClassLoader | í´ë˜ìŠ¤ ë™ì  ë¡œë”© |
| LevelTestData | í…ŒìŠ¤íŠ¸ ë°ì´í„° êµ¬ì¡° |
| TestDataAssembler | DTO â†’ Domain ë³€í™˜ |
| Validator ì²´ì¸ | ì½”ë“œ êµ¬ì¡° ê²€ì¦ |
| LevelGrader | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ ë° ë¹„êµ |
| Toolbox | í—¬í¼ í•¨ìˆ˜ ì£¼ì… |

ê° ì»´í¬ë„ŒíŠ¸ê°€ ë‹¨ì¼ ì±…ì„ì„ ê°€ì§€ê³ , ëª…í™•í•œ ì¸í„°í˜ì´ìŠ¤ë¡œ í˜‘ë ¥í•œë‹¤. ì´ êµ¬ì¡° ë•ë¶„ì—:

- ìƒˆ ë ˆë²¨ ì¶”ê°€: JSON íŒŒì¼ë§Œ ì‘ì„±
- ìƒˆ Validator ì¶”ê°€: `Validator` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- ìƒˆ Toolbox ì¶”ê°€: ì¸í„°í˜ì´ìŠ¤ ì •ì˜ + switch ë¶„ê¸° ì¶”ê°€

í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆê³ , ìˆ˜ì •ì—ëŠ” ë‹«í˜€ ìˆëŠ” êµ¬ì¡°ë¥¼ ì§€í–¥í–ˆë‹¤.
